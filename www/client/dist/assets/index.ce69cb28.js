var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n;import{o as r,c as l,a as c,b as u,R as d,w as h,r as p,d as g,e as m,f as v,g as b,h as f,i as w}from"./vendor.632f5b1b.js";const y={name:"App",components:{},data:()=>({burger:!1,alertType:"error",alertText:"",alertEnable:!1,alertTimeout:3e3,drawer:null,menuItems:[{text:"Jouer en ligne",icon:"mdi mdi-cards-playing-outline",page:"game",user:!0},{text:"Documentation",icon:"mdi mdi-file-document",page:"docs",user:!0}],evtSource:null}),computed:{isLogged(){return this.$store.getters["user/isLogged"]},isInitialized(){return this.$store.state.isinitialized}},methods:{logOut(){this.$api.destroyToken(),this.$router.push({name:"signin"})}},beforeCreate:function(){this.$api.loadToken(),this.$api.getMyProfile().then((e=>{e.success||console.log("Not logged in.")})).catch((e=>{console.log(e),console.log("Not logged in.")}))},created(){this.$eventHub.on("setAlert",((e,t,a)=>{this.alertText=e,this.alertType=t,this.alertTimeout=a,this.alertEnable=!0}))},beforeDestroy(){this.$eventHub.off("setAlert")},mounted(){this.evtSource=new EventSource(this.$api.getRESTApiUri()+"/servers/events"),this.evtSource.onerror=function(e){console.error("[SSE] failure (probaby closed):",e)},this.evtSource.addEventListener("servers",(e=>{})),this.evtSource.onopen=function(){console.log("EventSource open")}}},S={class:"navbar is-fixed-top is-link",role:"navigation","aria-label":"main navigation"},T={class:"navbar-brand"},k=c("a",{class:"navbar-item",href:"https://www.tarotclub.fr"},[c("img",{src:"/assets/logo.3a4ddd0d.png",width:"30",height:"50"})],-1),P=c("span",{"aria-hidden":"true"},null,-1),O=c("span",{"aria-hidden":"true"},null,-1),_=c("span",{"aria-hidden":"true"},null,-1),j=u('<div class="navbar-start"><a class="navbar-item"> Home </a><a class="navbar-item"> Documentation </a><div class="navbar-item has-dropdown is-hoverable"><a class="navbar-link"> More </a><div class="navbar-dropdown"><a class="navbar-item"> About </a><a class="navbar-item"> Jobs </a><a class="navbar-item"> Contact </a><hr class="navbar-divider"><a class="navbar-item"> Report an issue </a></div></div></div><div class="navbar-end"><div class="navbar-item"><div class="buttons"><a class="button is-primary"><strong>Sign up</strong></a><a class="button is-light"> Log in </a></div></div></div>',2);y.render=function(e,t,a,n,s,i){return r(),l("nav",S,[c("div",T,[k,c("a",{role:"button",onClick:t[1]||(t[1]=e=>s.burger=!s.burger),class:[{"is-active":s.burger},"navbar-burger"],"aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample"},[P,O,_],2)]),c("div",{id:"navbarBasicExample",class:["navbar-menu",{"is-active":s.burger}]},[j],2)])};const x={props:{image:{type:String,required:!0}},data:()=>({})},E=c("div",{class:"text-overline mb-4"}," OVERLINE ",-1),A=g(" Headline 5 "),R=g("Greyhound divisely hello coldly fonwderfully"),C=g(" Button ");x.render=function(e,t,a,n,s,i){const o=p("v-list-item-title"),u=p("v-list-item-subtitle"),d=p("v-list-item-content"),g=p("v-img"),m=p("v-list-item-avatar"),v=p("v-list-item"),b=p("v-btn"),f=p("v-card-actions"),w=p("v-card");return r(),l(w,{class:"mx-auto","max-width":"344",outlined:""},{default:h((()=>[c(v,{"three-line":""},{default:h((()=>[c(d,null,{default:h((()=>[E,c(o,{class:"text-h5 mb-1"},{default:h((()=>[A])),_:1}),c(u,null,{default:h((()=>[R])),_:1})])),_:1}),c(m,{tile:"",size:"80"},{default:h((()=>[c(g,{height:"80",src:a.image},null,8,["src"])])),_:1})])),_:1}),c(f,null,{default:h((()=>[c(b,{outlined:"",rounded:"",text:""},{default:h((()=>[C])),_:1})])),_:1})])),_:1})};const I={data:()=>({}),components:{DownloadTile:x},methods:{},beforeDestroy(){},mounted(){console.log("mounted home")}},W={class:"w3-main wa-center",style:{"max-width":"50%"}},L=c("h1",null,"TarotClub, le jeu de Tarot libre !",-1),$=c("p",{class:"lead"},"TarotClub est un jeu de Tarot libre (licence GPLv3) fonctionnant sur Windows, Linux et Mac OS X. Le but de ce site est de centraliser les informations autour du développement du jeu.",-1),D=g(" Modes de jeu "),N=c("p",null,"Partie rapide ou enchaînement",-1),M=c("p",null,"Jeu solo contre l'ordinateur",-1),U=c("p",null,"Donnes numérotées",-1),H=g(" Réseau "),J=c("p",null,"Jeu en réseau",-1),G=c("p",null,"Réseau local ou distant",-1),z=c("p",null,"Serveur intégré",-1),V=g(" Outils "),B=c("p",null,"Intelligence artificielle en JavaScript, modifiable",-1),q=c("p",null,"Éditeur de donne",-1),X=c("p",null,"Options de jeu (adversaires, jouerie)",-1),F=c("p",null,"Cartes de Tarot au format vectoriel (SVG)",-1),K=c("p",null,">Système de log avancé avec sauvegarde des parties jouées",-1);I.render=function(e,t,a,n,s,i){const o=p("v-img"),u=p("v-card-title"),d=p("v-card-text"),g=p("v-card"),m=p("v-col"),v=p("v-row"),b=p("DownloadTile");return r(),l("div",W,[L,$,c(o,{src:"img/screenshots/front.png"}),c(v,{class:"pa-20"},{default:h((()=>[c(m,null,{default:h((()=>[c(g,{flat:""},{default:h((()=>[c(u,null,{default:h((()=>[D])),_:1}),c(d,null,{default:h((()=>[N,M,U])),_:1})])),_:1})])),_:1}),c(m,null,{default:h((()=>[c(g,{flat:""},{default:h((()=>[c(u,null,{default:h((()=>[H])),_:1}),c(d,null,{default:h((()=>[J,G,z])),_:1})])),_:1})])),_:1}),c(m,null,{default:h((()=>[c(g,{flat:""},{default:h((()=>[c(u,null,{default:h((()=>[V])),_:1}),c(d,null,{default:h((()=>[B,q,X,F,K])),_:1})])),_:1})])),_:1})])),_:1}),c(v,null,{default:h((()=>[c(b,{image:"img/ubuntu.png"}),c(b,{image:"img/win.png"}),c(b,{image:"img/fedora.png"})])),_:1})])};const Q=m({connection:0,list:[],currentServer:null,isinitialized:!1,isIngame:!0});var Y={state:v(Q),setServers:function(e){Q.list=e}};const Z=b({history:f(),routes:[{path:"/",name:"home",component:I},{path:"/:catchAll(.*)",redirect:"/"}]}),ee=w(y).use(Z),te={all:ae=ae||new Map,on(e,t){const a=ae.get(e);a?a.push(t):ae.set(e,[t])},off(e,t){const a=ae.get(e);a&&(t?a.splice(a.indexOf(t)>>>0,1):ae.set(e,[]))},emit(e,t){let a=ae.get(e);a&&a.slice().map((e=>{e(t)})),a=ae.get("*"),a&&a.slice().map((a=>{a(e,t)}))}};var ae;const ne=new class{constructor(){this.baseURL=this.getRESTApiUri(),this.headers={Accept:"application/json","Content-Type":"application/json"},this.tokenName="tarotclub-token"}getRESTApiUri(){return this.getRootUrl()+"/api/v1"}getRootUrl(){return window.location.protocol+"//"+window.location.hostname}getWebSocketHost(){return"wss://"+window.location.hostname+"/clients"}setCookie(e,t,a){let n="";if(a){let e=new Date;e.setTime(e.getTime()+24*a*60*60*1e3),n="; expires="+e.toUTCString()}document.cookie=e+"="+(t||"")+n+"; path=/"}getCookie(e){let t=e+"=",a=document.cookie.split(";");for(let n=0;n<a.length;n++){let e=a[n];for(;" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(t))return e.substring(t.length,e.length)}return""}eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}async loadToken(){this.headers.Authorization="Bearer "+this.getCookie(this.tokenName)}async setToken(e){this.setCookie(this.tokenName,e,20),this.loadToken()}destroyToken(){this.eraseCookie(this.tokenName),this.loadToken()}async signup(e){return this.client("POST","/auth/signup",e)}async signin(e){return this.client("POST","/auth/signin",e)}async setNewPassword(e){return this.client("POST","/auth/newpassword",e)}async requestResetPassword(e){return this.client("POST","/auth/resetpassword",e)}async setMyProfile(e){return this.client("POST","/dashboard/user/profile",e)}async getMyProfile(){return this.client("GET","/dashboard/user/profile")}async getAllServers(){return this.client("GET","/servers/list")}async joinServer(e){return this.client("POST","/servers/join",{server:e})}async fetchWithTimeout(e,r){const l=new AbortController,c=setTimeout((()=>l.abort()),r.timeout),u=await fetch(e,(d=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))i.call(t,a)&&o(e,a,t[a]);return e})({},r),h={signal:l.signal},t(d,a(h))));var d,h;return clearTimeout(c),u}async client(e,t,a){const n={method:e,headers:this.headers,timeout:8e3};a&&(n.body=JSON.stringify(a));let s=this.baseURL+t;try{const e=await this.fetchWithTimeout(s,n);if(e.ok){console.log(await e.clone().text());return await e.json()}return Promise.reject(new Error("Invalid response"))}catch(i){return console.log(i),Promise.reject(new Error("Invalid response"))}}},se=new class{constructor(){var e;o(this,"symbol"!=typeof(e="handleWebSocketMessage")?e+"":e,(e=>{console.log("[WS] Received: "+e.data);let t=this.parsePacket(e.data);t.isValid?"RequestLogin"==t.data.cmd&&(this.player.uuid=t.data.uuid,this.replyLogin()):console.log("[WS] Invalid packet!")})),this.player={uuid:0,nickname:"PlayerUnknown",avatar:"",gender:"Human"}}connectToServer(){this.ws=new d(this.getWebSocketHost()),this.ws.onopen=this.handleWebSocketOpen,this.ws.onerror=this.handleWebSocketError,this.ws.onmessage=this.handleWebSocketMessage}handleWebSocketError(e){}handleWebSocketOpen(e){}getWebSocketHost(){let e=("https:"===window.location.protocol?"wss://":"ws://")+window.location.hostname+":4270";return console.log("Web socket host: "+e),e}replyLogin(){let e={cmd:"ReplyLogin",nickname:this.player.nickname,avatar:this.player.avatar,gender:this.player.gender};this.send(1,e)}paddedInt(e){return e.toString(16).padStart(4,"0")}parsePacket(e){let t={options:0,uuid_dst:0,uuid_src:0,data:{},isValid:!1};if(e.length>=25){const n=e.substring(0,22).split(":"),s=e.slice(23);if(n.length>=5)try{t.data=JSON.parse(s),t.options=parseInt(n[0],16),t.uuid_src=parseInt(n[1],16),t.uuid_dst=parseInt(n[2],16),"DATA"==n[4]&&(t.isValid=!0)}catch(a){console.error(a)}}return t}send(e,t){try{const a=JSON.stringify(t);let n="00:"+this.paddedInt(this.player.uuid)+":"+this.paddedInt(e)+":"+this.paddedInt(a.length)+":DATA:"+a;this.ws.send(n)}catch(a){console.log("[TarotClient] "+a)}}getRootUrl(){return window.location.protocol+"//"+window.location.host}};ee.config.globalProperties.$eventHub=te,ee.config.globalProperties.$api=ne,ee.config.globalProperties.$tc=se,ee.config.globalProperties.$store=Y,ee.mount("#app");
